---
const {
  variant = "primary", // "primary" | "secondary" | "ghost" | "link"
  size = "md", // accepts "large|medium|small|lg|md|sm|xs"
  href,
  type = "button",
  disabled = false,
  class: className = "",
  ariaLabel,
  ...rest
} = Astro.props;

const base =
  "inline-flex items-center justify-center gap-2 font-body font-normal text-body-xs rounded-[12px] transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--focus-ring-color)] disabled:cursor-not-allowed";

const sizeMap: Record<string, "lg" | "md" | "sm" | "xs"> = {
  large: "lg",
  medium: "md",
  small: "sm",
  lg: "lg",
  md: "md",
  sm: "sm",
  xs: "xs",
};

const resolvedSize = sizeMap[size] ?? "md";

const sizes = {
  lg: "h-14 px-7 py-5",
  md: "h-14 px-7 py-5",
  sm: "h-12 px-5 py-4",
  xs: "h-12 px-5 py-4",
};

const variants = {
  primary:
    "bg-[color:var(--button-primary-bg)] text-[color:var(--button-primary-text)] hover:bg-[color:var(--button-primary-bg-hover)]",
  secondary:
    "bg-[color:var(--button-secondary-bg)] text-[color:var(--button-secondary-text)] border border-[color:var(--button-secondary-border)] hover:bg-[color:var(--button-secondary-bg-hover)] hover:border-[color:var(--button-secondary-border-hover)] hover:text-[color:var(--button-secondary-text-hover)]",
  ghost:
    "bg-action-ghost text-ink-primary border border-transparent hover:bg-action-ghost-hover active:bg-action-ghost-hover",
  link:
    "bg-transparent text-action-link underline decoration-2 underline-offset-4 border border-transparent hover:text-action-link-hover active:text-action-link-hover",
};

const disabledVariants = {
  primary:
    "bg-[color:var(--button-primary-bg-disabled)] text-[color:var(--button-primary-text-disabled)]",
  secondary:
    "bg-[color:var(--button-secondary-bg-disabled)] text-[color:var(--button-secondary-text-disabled)] border border-[color:var(--button-secondary-border-disabled)]",
  ghost: "bg-surface-muted text-ink-muted border border-border-subtle",
  link: "bg-transparent text-ink-muted border border-transparent no-underline",
};

const toneClasses = disabled
  ? disabledVariants[variant] ?? disabledVariants.primary
  : variants[variant] ?? variants.primary;

const classes = `${base} ${sizes[resolvedSize]} ${toneClasses} ${className}`.trim();
---

{href ? (
  <a
    href={disabled ? undefined : href}
    role="button"
    aria-disabled={disabled}
    tabIndex={disabled ? -1 : 0}
    class={classes}
    aria-label={ariaLabel}
    {...rest}
  >
    <slot />
  </a>
) : (
  <button type={type} class={classes} aria-label={ariaLabel} disabled={disabled} {...rest}>
    <slot />
  </button>
)}
